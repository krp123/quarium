<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<window xmlns="http://schemas.haulmont.com/cuba/screen/window.xsd"
        caption="msg://projectEdit.caption"
        focusComponent="form"
        messagesPack="com.company.quarium.web.screens.project">
    <data>
        <instance id="projectDc"
                  class="com.company.quarium.entity.project.SimpleProject">
            <view extends="simpleProject-view">
                <property name="qa" view="edit"/>
                <property name="configuration" view="edit"/>
                <property name="checklist" view="project-checklist-view"/>
                <property name="createTs"/>
                <property name="module" view="edit"/>
                <property name="regressChecklist" view="regressChecklist-view"/>
                <property name="projectVersion" view="projectVersion-view"/>
                <property name="dbms" view="_local"/>
                <property name="thesisVersion" view="_local"/>
                <property name="milestone" view="_local"/>
                <property name="testRun" view="testRun-view"/>
            </view>
            <loader/>
            <collection id="qaProjectDc" property="qa"/>
            <collection id="configurationProjectDc" property="configuration"/>
            <collection id="checklistsDc" property="checklist"/>
            <collection id="modulesDc" property="module"/>
            <collection id="regressChecklistDc" property="regressChecklist"/>
            <collection id="versionsDc" property="projectVersion"/>
            <collection id="milestonesDc" property="milestone"/>
            <collection id="testRunsDc" property="testRun"/>
        </instance>
        <collection id="qaDc" class="com.company.quarium.entity.project.QaProjectRelationship" view="edit">
            <loader id="qaDl">
                <query>
                    <![CDATA[select e from quarium_QaProjectRelationship e
                    where e.project = :project]]>
                </query>
            </loader>
        </collection>
        <collection id="dbmsDc" class="com.company.quarium.entity.references.Dbms" view="_minimal">
            <loader id="dbmsDl">
                <query>
                    <![CDATA[select e from quarium_Dbms e]]>
                </query>
            </loader>
        </collection>
        <collection id="thesisVersionDc" class="com.company.quarium.entity.references.ThesisVersion" view="_minimal">
            <loader id="thesisVersionDl">
                <query>
                    <![CDATA[select e from quarium_ThesisVersion e]]>
                </query>
            </loader>
        </collection>
    </data>
    <dialogMode height="600"
                width="800"/>
    <layout expand="projectTabSheet" spacing="true">
        <tabSheet id="projectTabSheet">
            <tab id="detailsTab" caption="msg://projectEdit.details" margin="true">
                <vbox expand="relationshipsBox">
                    <form id="form" dataContainer="projectDc">
                        <column width="350px">
                            <textField id="projectNameField" property="projectName" required="true"/>
                            <textArea id="descriptionField" property="description" rows="5"/>
                        </column>
                        <column>
                            <lookupField id="thesisVersion" property="thesisVersion"
                                         optionsContainer="thesisVersionDc"/>
                            <lookupField id="dbms" property="dbms" optionsContainer="dbmsDc"/>
                        </column>
                    </form>
                    <vbox id="relationshipsBox" margin="true" width="auto">
                        <form id="relationshipsForm">
                            <column>
                                <groupBox id="qaBox" caption="msg://com.company.quarium.entity/Project.qa"
                                          collapsable="true">
                                    <table id="qaProjectRelationshipsTable"
                                           dataContainer="qaProjectDc"
                                           width="450px"
                                           height="250px"
                                           multiselect="true">
                                        <actions>
                                            <action id="addQa" type="add"/>
                                            <action id="removeQa" type="remove"/>
                                        </actions>
                                        <columns>
                                            <column id="qa"/>
                                        </columns>
                                        <buttonsPanel>
                                            <button action="qaProjectRelationshipsTable.addQa"/>
                                            <button action="qaProjectRelationshipsTable.removeQa"/>
                                        </buttonsPanel>
                                    </table>
                                </groupBox>
                            </column>
                            <column>
                                <groupBox id="moduleBox"
                                          caption="msg://com.company.quarium.entity/Project.modulesList"
                                          collapsable="true">
                                    <table id="modulesTable"
                                           dataContainer="modulesDc"
                                           width="450px"
                                           height="250px"
                                           multiselect="true">
                                        <actions>
                                            <action id="createModule" type="create">
                                                <properties>
                                                    <property name="screenClass"
                                                              value="com.company.quarium.web.screens.module.ModuleEdit"/>
                                                </properties>
                                            </action>
                                            <action id="editModule" type="edit">
                                                <properties>
                                                    <property name="screenClass"
                                                              value="com.company.quarium.web.screens.module.ModuleEdit"/>
                                                </properties>
                                            </action>
                                            <action id="removeModule" type="remove"/>
                                        </actions>
                                        <columns>
                                            <column id="name"
                                                    caption="msg://com.company.quarium.entity/Project.modules"/>
                                        </columns>
                                        <buttonsPanel>
                                            <button action="modulesTable.createModule"/>
                                            <button action="modulesTable.editModule"/>
                                            <button action="modulesTable.removeModule"/>
                                        </buttonsPanel>
                                    </table>
                                </groupBox>
                            </column>
                            <column>
                                <groupBox id="configurationBox"
                                          caption="msg://com.company.quarium.entity/Project.configurationList"
                                          collapsable="true">
                                    <table id="configurationProjectRelationshipsTable"
                                           dataContainer="configurationProjectDc"
                                           width="450px"
                                           height="250px"
                                           multiselect="true">
                                        <actions>
                                            <action id="addConfiguration" type="add"/>
                                            <action id="removeConfiguration" type="remove"/>
                                        </actions>
                                        <columns>
                                            <column id="configuration"
                                                    caption="msg://com.company.quarium.entity/Project.configuration"/>
                                        </columns>
                                        <buttonsPanel>
                                            <button action="configurationProjectRelationshipsTable.addConfiguration"/>
                                            <button action="configurationProjectRelationshipsTable.removeConfiguration"/>
                                        </buttonsPanel>
                                    </table>
                                </groupBox>
                            </column>
                        </form>
                    </vbox>
                </vbox>
            </tab>
            <tab id="milestonesTab" caption="msg://projectEdit.milestone" spacing="true" margin="true"
                 expand="milestonesTable">
                <groupTable id="milestonesTable"
                            width="100%"
                            dataContainer="milestonesDc"
                            multiselect="true" height="100%">
                    <actions>
                        <action id="create" type="create">
                            <properties>
                                <property name="screenClass"
                                          value="com.company.quarium.web.screens.milestone.MilestoneEdit"/>
                            </properties>
                        </action>
                        <action id="edit" type="edit">
                            <properties>
                                <property name="screenClass"
                                          value="com.company.quarium.web.screens.milestone.MilestoneEdit"/>
                            </properties>
                        </action>
                        <action id="remove" type="remove"/>
                    </actions>
                    <columns>
                        <column id="name"/>
                        <column id="startDate"/>
                        <column id="finishDate"/>
                        <column id="status"/>
                    </columns>
                    <rows/>
                    <buttonsPanel id="milestonesButtonsPanel"
                                  alwaysVisible="true">
                        <button id="milestoneCreateBtn" action="milestonesTable.create"/>
                        <button id="milestoneEditBtn" action="milestonesTable.edit"/>
                        <button id="milestoneRemoveBtn" action="milestonesTable.remove"/>
                    </buttonsPanel>
                </groupTable>
            </tab>
            <tab id="testSuitsTab" caption="msg://projectEdit.testSuits" spacing="true" margin="true">
                <vbox expand="checklistBox" spacing="true" height="100%">
                    <vbox id="checklistBox" width="100%" margin="true" spacing="true">
                        <groupTable id="checklistsTable"
                                    width="100%"
                                    height="100%"
                                    dataContainer="checklistsDc"
                                    multiselect="true"
                                    presentations="true">
                            <actions>
                                <action id="create" type="create">
                                    <properties>
                                        <property name="screenClass"
                                                  value="com.company.quarium.web.screens.checklist.TestSuitEdit"/>
                                    </properties>
                                </action>
                                <action id="addChecklist" type="add"/>
                                <action id="edit" type="edit">
                                    <properties>
                                        <property name="screenClass"
                                                  value="com.company.quarium.web.screens.checklist.TestSuitEdit"/>
                                    </properties>
                                </action>
                                <action id="remove" type="remove"/>
                            </actions>
                            <columns>
                                <column id="name"/>
                                <column id="module" caption="msg://projectEdit.module"/>
                            </columns>
                            <rowsCount/>
                            <buttonsPanel id="buttonsPanel"
                                          alwaysVisible="true">
                                <button id="createBtn" action="checklistsTable.create"/>
                                <button id="addBtn" action="checklistsTable.addChecklist" icon="ADD_TO_SET_ACTION"/>
                                <button id="editBtn" action="checklistsTable.edit"/>
                                <button id="removeBtn" action="checklistsTable.remove"/>
                                <button id="uploadExcel"
                                        caption="msg://checklistBrowse.uploadXlsx"
                                        icon="font-icon:FILE_EXCEL_O"/>
                            </buttonsPanel>
                        </groupTable>
                    </vbox>
                </vbox>
            </tab>
            <tab id="testRunsTab" caption="msg://projectEdit.testRuns" spacing="true" margin="true"
                 expand="testRunsTable">
                <groupTable id="testRunsTable"
                            width="100%"
                            dataContainer="testRunsDc"
                            height="100%">
                    <actions>
                        <action id="create" type="create">
                            <properties>
                                <property name="screenClass"
                                          value="com.company.quarium.web.screens.testrun.TestRunEdit"/>
                            </properties>
                        </action>
                        <action id="edit" type="edit">
                            <properties>
                                <property name="screenClass"
                                          value="com.company.quarium.web.screens.testrun.TestRunEdit"/>
                            </properties>
                        </action>
                        <action id="remove" type="remove"/>
                    </actions>
                    <columns>
                        <column id="name"/>
                    </columns>
                    <rows/>
                    <buttonsPanel id="testRunsButtonsPanel"
                                  alwaysVisible="true">
                        <button id="testRunCreateBtn" action="testRunsTable.create"/>
                        <button id="testRunEditBtn" action="testRunsTable.edit"/>
                        <button id="testRunRemoveBtn" action="testRunsTable.remove"/>
                    </buttonsPanel>
                </groupTable>
            </tab>
        </tabSheet>
        <hbox id="editActions" spacing="true" align="BOTTOM_LEFT">
            <button id="commitAndCloseBtn" action="windowCommitAndClose"/>
            <button id="closeBtn" action="windowClose"/>
            <button id="saveBtn" caption="msg://projectEdit.save"/>
        </hbox>
    </layout>
</window>
